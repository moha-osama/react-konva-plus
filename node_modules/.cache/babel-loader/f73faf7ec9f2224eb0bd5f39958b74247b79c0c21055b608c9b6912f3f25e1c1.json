{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { Group } from 'react-konva';\nconst needForceStyle = el => {\n  const pos = window.getComputedStyle(el).position;\n  const ok = pos === 'absolute' || pos === 'relative';\n  return !ok;\n};\nexport function useEvent(fn = () => {}) {\n  const ref = React.useRef(fn);\n  ref.current = fn;\n  return React.useCallback((...args) => {\n    return ref.current.apply(null, args);\n  }, []);\n}\nexport const Html = ({\n  children,\n  groupProps,\n  divProps,\n  transform,\n  transformFunc\n}) => {\n  const groupRef = React.useRef(null);\n  const container = React.useRef();\n  const [div] = React.useState(() => document.createElement('div'));\n  const root = React.useMemo(() => ReactDOM.createRoot(div), [div]);\n  const shouldTransform = transform !== null && transform !== void 0 ? transform : true;\n  const handleTransform = useEvent(() => {\n    if (shouldTransform && groupRef.current) {\n      const tr = groupRef.current.getAbsoluteTransform();\n      let attrs = tr.decompose();\n      if (transformFunc) {\n        attrs = transformFunc(attrs);\n      }\n      div.style.position = 'absolute';\n      div.style.zIndex = '10';\n      div.style.top = '0px';\n      div.style.left = '0px';\n      div.style.transform = `translate(${attrs.x}px, ${attrs.y}px) rotate(${attrs.rotation}deg) scaleX(${attrs.scaleX}) scaleY(${attrs.scaleY})`;\n      div.style.transformOrigin = 'top left';\n    } else {\n      div.style.position = '';\n      div.style.zIndex = '';\n      div.style.top = '';\n      div.style.left = '';\n      div.style.transform = ``;\n      div.style.transformOrigin = '';\n    }\n    const _a = divProps || {},\n      {\n        style\n      } = _a,\n      restProps = __rest(_a, [\"style\"]);\n    Object.assign(div.style, style);\n    Object.assign(div, restProps);\n  });\n  React.useLayoutEffect(() => {\n    var _a;\n    const group = groupRef.current;\n    if (!group) {\n      return;\n    }\n    const parent = (_a = group.getStage()) === null || _a === void 0 ? void 0 : _a.container();\n    if (!parent) {\n      return;\n    }\n    parent.appendChild(div);\n    if (shouldTransform && needForceStyle(parent)) {\n      parent.style.position = 'relative';\n    }\n    group.on('absoluteTransformChange', handleTransform);\n    handleTransform();\n    return () => {\n      var _a;\n      group.off('absoluteTransformChange', handleTransform);\n      (_a = div.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(div);\n    };\n  }, [shouldTransform]);\n  React.useLayoutEffect(() => {\n    handleTransform();\n  }, [divProps, transformFunc]);\n  React.useLayoutEffect(() => {\n    root.render(children);\n  });\n  React.useLayoutEffect(() => {\n    return () => {\n      setTimeout(() => {\n        root.unmount();\n      });\n    };\n  }, []);\n  return React.createElement(Group, Object.assign({\n    ref: groupRef\n  }, groupProps));\n};","map":{"version":3,"names":["__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","React","ReactDOM","Group","needForceStyle","el","pos","window","getComputedStyle","position","ok","useEvent","fn","ref","useRef","current","useCallback","args","apply","Html","children","groupProps","divProps","transform","transformFunc","groupRef","container","div","useState","document","createElement","root","useMemo","createRoot","shouldTransform","handleTransform","tr","getAbsoluteTransform","attrs","decompose","style","zIndex","top","left","x","y","rotation","scaleX","scaleY","transformOrigin","_a","restProps","assign","useLayoutEffect","group","parent","getStage","appendChild","on","off","parentNode","removeChild","render","setTimeout","unmount"],"sources":["D:/Work/00-Mogul/konva v2/node_modules/react-konva-utils/es/html.js"],"sourcesContent":["var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { Group } from 'react-konva';\nconst needForceStyle = (el) => {\n    const pos = window.getComputedStyle(el).position;\n    const ok = pos === 'absolute' || pos === 'relative';\n    return !ok;\n};\nexport function useEvent(fn = () => { }) {\n    const ref = React.useRef(fn);\n    ref.current = fn;\n    return React.useCallback((...args) => {\n        return ref.current.apply(null, args);\n    }, []);\n}\nexport const Html = ({ children, groupProps, divProps, transform, transformFunc, }) => {\n    const groupRef = React.useRef(null);\n    const container = React.useRef();\n    const [div] = React.useState(() => document.createElement('div'));\n    const root = React.useMemo(() => ReactDOM.createRoot(div), [div]);\n    const shouldTransform = transform !== null && transform !== void 0 ? transform : true;\n    const handleTransform = useEvent(() => {\n        if (shouldTransform && groupRef.current) {\n            const tr = groupRef.current.getAbsoluteTransform();\n            let attrs = tr.decompose();\n            if (transformFunc) {\n                attrs = transformFunc(attrs);\n            }\n            div.style.position = 'absolute';\n            div.style.zIndex = '10';\n            div.style.top = '0px';\n            div.style.left = '0px';\n            div.style.transform = `translate(${attrs.x}px, ${attrs.y}px) rotate(${attrs.rotation}deg) scaleX(${attrs.scaleX}) scaleY(${attrs.scaleY})`;\n            div.style.transformOrigin = 'top left';\n        }\n        else {\n            div.style.position = '';\n            div.style.zIndex = '';\n            div.style.top = '';\n            div.style.left = '';\n            div.style.transform = ``;\n            div.style.transformOrigin = '';\n        }\n        const _a = divProps || {}, { style } = _a, restProps = __rest(_a, [\"style\"]);\n        Object.assign(div.style, style);\n        Object.assign(div, restProps);\n    });\n    React.useLayoutEffect(() => {\n        var _a;\n        const group = groupRef.current;\n        if (!group) {\n            return;\n        }\n        const parent = (_a = group.getStage()) === null || _a === void 0 ? void 0 : _a.container();\n        if (!parent) {\n            return;\n        }\n        parent.appendChild(div);\n        if (shouldTransform && needForceStyle(parent)) {\n            parent.style.position = 'relative';\n        }\n        group.on('absoluteTransformChange', handleTransform);\n        handleTransform();\n        return () => {\n            var _a;\n            group.off('absoluteTransformChange', handleTransform);\n            (_a = div.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(div);\n        };\n    }, [shouldTransform]);\n    React.useLayoutEffect(() => {\n        handleTransform();\n    }, [divProps, transformFunc]);\n    React.useLayoutEffect(() => {\n        root.render(children);\n    });\n    React.useLayoutEffect(() => {\n        return () => {\n            setTimeout(() => {\n                root.unmount();\n            });\n        };\n    }, []);\n    return React.createElement(Group, Object.assign({ ref: groupRef }, groupProps));\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}